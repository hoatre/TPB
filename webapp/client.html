<html>
  <head>

    <title>Heart Beat Dashboard</title>
   
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">

    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script type="text/javascript" src="http://localhost:3000/socket.io/socket.io.js"></script>
    <!--<script type="text/javascript" src="smoothie.js"></script>-->
      <script type="text/javascript" src="http://github.com/joewalnes/smoothie/raw/master/smoothie.js"></script>
    <script type="text/javascript" src="canvasjs.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <script type="text/javascript">
      var socket = io.connect('http://localhost:3000/');

      socket.on('connect', function(data){
        setStatus('connected');
        socket.emit('subscribe-1', {channel:'real-time-Branch 1'});
          socket.emit('subscribe-2', {channel:'real-time-Branch 2'});
          socket.emit('subscribe-3', {channel:'real-time-Branch 3'});
          socket.emit('subscribe-4', {channel:'real-time-Contact Center'});
          
          //minutes

          socket.emit('subscribe-5', {channel:'real-time-minutes-Branch 1'});
          socket.emit('subscribe-6', {channel:'real-time-minutes-Branch 2'});
          socket.emit('subscribe-7', {channel:'real-time-minutes-Branch 3'});
          socket.emit('subscribe-8', {channel:'real-time-minutes-Contact Center'});
      });

      socket.on('reconnecting', function(data){
        setStatus('reconnecting');
      });

//      socket.on('message', function (channel, data) {
//        console.log('received a message: ', data);
//          switch(channel) {
//              case 'real-time-Branch 1':
//                  line1.append(new Date().getTime(), data);
//                  break;
//              case 'real-time-Branch 2':
//                  line2.append(new Date().getTime(), data);
//                  break;
//              case 'real-time-Branch 3':
//                  line3.append(new Date().getTime(), data);
//                  break;
//              case 'real-time-Contact Center':
//                  line4.append(new Date().getTime(), data);
//                  break;
//              case 'real-time-minutes-Branch 1':
//                  line5.append(new Date().getTime(), data);
//                  break;
//              case 'real-time-minutes-Branch 2':
//                  line6.append(new Date().getTime(), data);
//                  break;
//              case 'real-time-minutes-Branch 3':
//                  line7.append(new Date().getTime(), data);
//                  break;
//              case 'real-time-minutes-Contact Center':
//                  line8.append(new Date().getTime(), data);
//                  break;
//              default:
//                    break;
//          }
//
//        //createTimeline();
//        //addMessage(data);
//      });

      function addMessage(data) {
          $('#online').html(data);
      }

      // Randomly add a data point every 500ms
      var random = new TimeSeries();
      // Data
      var line1 = new TimeSeries();
      var line2 = new TimeSeries();
      var line3 = new TimeSeries();
      var line4 = new TimeSeries();
      
      //minutes

      var line5 = new TimeSeries();
      var line6 = new TimeSeries();
      var line7 = new TimeSeries();
      var line8 = new TimeSeries();
      //var chartCD =  [2, 0, 4, 2, 5, 6, 7, 8, 4, 2, 0, 8];
//      setInterval(function() {
//          var socket = io.connect();
//
//          socket.on('connect',function(data){
//              //line1.append(new Date().getTime(), data);
//              //line2.append(new Date().getTime(), data);
//              //line3.append(new Date().getTime(), data);
//              //line4.append(new Date().getTime(), data);
//              createTimeline();
//          });
//
//      }, 1000);

      function myYRangeFunction(range) {
          // TODO implement your calculation using range.min and range.max
          var min = 0;
          var max = 10;
          return {min: min, max: max};
      }
      setInterval(function() {
          socket.on('CountChart-real-time-Branch 1', function (data1) {
              line1.append(new Date().getTime(), data1);
          });
          socket.on('CountChart-real-time-Branch 2', function (data1) {
              line2.append(new Date().getTime(), data1);
          });
          socket.on('CountChart-real-time-Branch 3', function (data1) {
              line3.append(new Date().getTime(), data1);
          });
          socket.on('CountChart-real-time-Contact Center', function (data1) {
              line4.append(new Date().getTime(), data1);
          });
          socket.on('Total-TotalNoTran', function (data1) {
              var TotalNoTran = document.getElementById("TotalNoTran");
              TotalNoTran.innerHTML = data1.toString();
          });
          socket.on('Total-TotalAmount', function (data1) {
              var TotalAmount = document.getElementById("TotalAmount");
              TotalAmount.innerHTML = data1.toString();
          });
          socket.on('Total-TotalAmount', function (data1) {
              var TotalAmount = document.getElementById("TotalAmount");
              TotalAmount.innerHTML = data1.toString();
          });
          socket.on('Total-TotalAmount', function (data1) {
              var TotalAmount = document.getElementById("TotalAmount");
              TotalAmount.innerHTML = data1.toString();
          });
      }, 1000);
      function TopTen(Top){
          socket.on('Top-' + Top, function (data1) {
              var array = $.map(data1, function(value, index) {
                  return [value];
              });
              var TopTenDepsitsTop1Acc = document.getElementById(Top + "-Account");
              TopTenDepsitsTop1Acc.innerHTML = array[0];
              var TopTenDepsitsTop1Amount = document.getElementById(Top + "-Amount");
              TopTenDepsitsTop1Amount.innerHTML = array[1];
          });
      }
      setInterval(function() {
          TopTen('TopTenDepsits-Top1');
          TopTen('TopTenDepsits-Top2');
          TopTen('TopTenDepsits-Top3');
          TopTen('TopTenWithdrawals-Top1');
          TopTen('TopTenWithdrawals-Top2');
          TopTen('TopTenWithdrawals-Top3');
      }, 10000);
      var chart = new SmoothieChart({
                  millisPerPixel: 50,
                  grid: {
                      fillStyle: 'transparent',
                      strokeStyle: 'rgba(166,197,103,0.20)',
                      //sharpLines: true,
                      //millisPerLine: 5000,
                      verticalSections: 8,
                      borderVisible: false
                  },
                  labels: { fillStyle: '#000000' }
              }),canvas = document.getElementById('chart'),
              series = new TimeSeries();
      function createTimeline() {
          $('#line11').on('click', line11);
          $('#line21').on('click', line21);
          $('#line31').on('click', line31);
          $('#line41').on('click', line41);

          TopTen('TopTenDepsits-Top1');
          TopTen('TopTenDepsits-Top2');
          TopTen('TopTenDepsits-Top3');
          TopTen('TopTenWithdrawals-Top1');
          TopTen('TopTenWithdrawals-Top2');
          TopTen('TopTenWithdrawals-Top3');

          chart.addTimeSeries(line1,
                  { strokeStyle: '#A6C567', fillStyle: 'rgba(166,197,103,0.20)', lineWidth:3 });
          chart.addTimeSeries(line2,
                  { strokeStyle:'rgb(255, 0, 255)', fillStyle:'rgba(255, 0, 255, 0.3)', lineWidth:3 });
          chart.addTimeSeries(line3,
                  { strokeStyle:'rgb(255, 255, 0)', fillStyle:'rgba(255, 255, 0, 0.4)', lineWidth:3 });
          chart.addTimeSeries(line4,
                  { strokeStyle:'rgb(0, 0, 255)', fillStyle:'rgba(0, 0, 255, 0.2)', lineWidth:3 });

          chart.streamTo(document.getElementById("chart"), 1000);


          //createLineChart();
          //alert('1');
      }


      function setStatus(msg) {
          console.log('Connection Status : ' + msg);
      }
//      function createChart(){

//      }
//      function createLineChart() {
//          //alert('2');
//          //socket.on('connect',function(data) {
//              //subscribe.on("message", function(channel, message) {
//                  socket.on('listChart-real-time-60s-Branch 1',function(data1){
////                      socket.on('listChart-real-time-60s-Branch 2',function(data2){
////                          socket.on('listChart-real-time-60s-Branch 3',function(data3){
////                              socket.on('listChart-real-time-60s-Contact Center',function(data4){
//
//                                  var array = $.map(data1, function(value, index) {
//                                      //alert(value);
//                                      return [value];
//                                  });
////                                  var array2 = $.map(data2, function(value, index) {
////                                      //alert(value);
////                                      return [value];
////                                  });
////                                  var array3 = $.map(data3, function(value, index) {
////                                      //alert(value);
////                                      return [value];
////                                  });
////                                  var array4 = $.map(data4, function(value, index) {
////                                      //alert(value);
////                                      return [value];
////                                  });
//
//                      //var limit = 100000;    //increase number of dataPoints by increasing this
//
//                                  var y = 0;
//                                  var data = []; var dataSeries1 = { type: "line" };
////                                  var dataSeries4 = { type: "line" };
////                                  var dataSeries2 = { type: "line" };
////                                  var dataSeries3 = { type: "line" };
//
//                                  var dataPoints1 = [];
////                                  var dataPoints4 = [];
////                                  var dataPoints2 = [];
////                                  var dataPoints3 = [];
//                                  for (var i = 0; i < array.length; i += 1) {
//                                      //alert(array[i]);
//                                      //y += 1;
//                                      dataPoints1.push({
//                                          x: i + 1,
//                                          y: parseInt(array[i])
//                                      });
//                                  }
////                                  for (var i = 0; i < array2.length; i += 1) {
////                                      //alert(array[i]);
////                                      //y += 1;
////                                      dataPoints2.push({
////                                          x: i + 1,
////                                          y: parseInt(array2[i])
////                                      });
////                                  }
////                                  for (var i = 0; i < array3.length; i += 1) {
////                                      //alert(array[i]);
////                                      //y += 1;
////                                      dataPoints1.push({
////                                          x: i + 1,
////                                          y: parseInt(array3[i])
////                                      });
////                                  }
////                                  for (var i = 0; i < array4.length; i += 1) {
////                                      //alert(array[i]);
////                                      //y += 1;
////                                      dataPoints1.push({
////                                          x: i + 1,
////                                          y: parseInt(array4[i])
////                                      });
////                                  }
//                                  dataSeries1.dataPoints = dataPoints1;
////                                  dataSeries2.dataPoints = dataPoints2;
////                                  dataSeries3.dataPoints = dataPoints3;
////                                  dataSeries4.dataPoints = dataPoints4;
//                                  data.push(dataSeries1);
////                                  data.push(dataSeries2);
////                                  data.push(dataSeries3);
////                                  data.push(dataSeries4);
//
//
//                      var chartCD1 = new CanvasJS.Chart("chartCD",
//                              {
//
//                                  data: data  // random generator below
//
//                              });
//
//                      chartCD1.render();
//                      });
////                          });
////                      });
////                  });
//              //});
//          //});
//
//
//      }

      function line11() {
          if($('#line11').is(':checked'))
              chart.addTimeSeries(line1,
                      { strokeStyle: '#A6C567', fillStyle: 'rgba(166,197,103,0.20)', lineWidth:3 });
          else{
              chart.removeTimeSeries(line1);
          }
      }


      function line21() {
          if($('#line21').is(':checked'))
              chart.addTimeSeries(line2,
                      { strokeStyle:'rgb(255, 0, 255)', fillStyle:'rgba(255, 0, 255, 0.3)', lineWidth:3 });
          else{
              chart.removeTimeSeries(line2);
          }
      }

      function line31() {
          if($('#line31').is(':checked'))
              chart.addTimeSeries(line3,
                      { strokeStyle:'rgb(255, 255, 0)', fillStyle:'rgba(255, 255, 0, 0.4)', lineWidth:3 });
          else{
              chart.removeTimeSeries(line3);
          }
      }

      function line41() {
          if($('#line41').is(':checked'))
              chart.addTimeSeries(line4,
                      { strokeStyle:'rgb(0, 0, 255)', fillStyle:'rgba(0, 0, 255, 0.2)', lineWidth:3 });
          else{
              chart.removeTimeSeries(line4);
          }
      }
    </script>
  </head>

  <body onload="createTimeline()">
  <table>
      <tr>
          <td>Total transactions in a second</td>
      </tr>
      <tr>
          <td>
          <canvas id="chart" width="1000px" height="200px"></canvas>
          </td>
      </tr>
      <ul>
          <li><input type="checkbox" id="line11" name="Line11" checked="true" />real-time-Branch 1 </li>
          <li><input type="checkbox" id="line21" name="Line21" checked="true"/>real-time-Branch 2</li>
          <li><input type="checkbox" id="line31" name="Line31" checked="true"/>real-time-Branch 3</li>
          <li><input type="checkbox" id="line41" name="Line41" checked="true"/>real-time-Contact Center</li>
      </ul>
  </table>
    <table width="1000px">
        <colgroup>
            <col width="25%">
        </colgroup>
      <tr>
          <td colspan="2">
              Total No. of Transactions : <label id="TotalNoTran"></label>
          </td>

          <td colspan="2"> Total Amount : <label id="TotalAmount"></label> </td>

      </tr>
      <tr>
          <td colspan="2">
              Top Ten Deposits
          </td>


          <td colspan="2">
              Top Ten Withdrawals
          </td>


      </tr>
      <tr>
          <td>
              Account
          </td>
          <td>
              Amount
          </td>

          <td>
              Account
          </td>
          <td>
              Amount
          </td>

      </tr>
      <tr>
          <td>
              <label id="TopTenDepsits-Top1-Account"></label>
          </td>
          <td>
              <label id="TopTenDepsits-Top1-Amount"></label>
          </td>

          <td>
              <label id="TopTenWithdrawals-Top1-Account"></label>
          </td>
          <td>
              <label id="TopTenWithdrawals-Top1-Amount"></label>
          </td>

      </tr>
      <tr>
          <td>
              <label type="text" id="TopTenDepsits-Top2-Account"></label>
          </td>
          <td>
              <label type="text" id="TopTenDepsits-Top2-Amount"></label>
          </td>

          <td>
              <label type="text" id="TopTenWithdrawals-Top2-Account"></label>
          </td>
          <td>
              <label type="text" id="TopTenWithdrawals-Top2-Amount"></label>
          </td>

      </tr>
      <tr>
          <td>
              <label type="text" id="TopTenDepsits-Top3-Account"></label>
          </td>
          <td>
              <label type="text" id="TopTenDepsits-Top3-Amount"></label>
          </td>

          <td>
              <label type="text" id="TopTenWithdrawals-Top3-Account"></label>
          </td>
          <td>
              <label type="text" id="TopTenWithdrawals-Top3-Amount"></label>
          </td>

      </tr>
  </table>

  </body>
</html>

